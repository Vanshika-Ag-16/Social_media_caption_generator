# -*- coding: utf-8 -*-
"""social_media_caption_generator.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1PmjxGRiIGs8j1vRF3bgVzCdR5aGLrLEX
"""

!pip install transformers gradio

import gradio as gr
from transformers import pipeline
import random

caption_generator = pipeline("text-generation", model = "gpt2")

emoji_dict = {
    "positive": ["😊","🌟","🔥","💪","🚀","✨"],
    "negative": ["😢","😔","💔","😠","😥"],
    "neutral": ["😐","😑","😶","😐","🤔","🧐"]
}

sentiment_pipeline = pipeline("sentiment-analysis")

def get_emojis(text):
  label = sentiment_pipeline(text)[0]["label"].lower()
  return ''.join(random.sample(emoji_dict.get(label, ["😐"]),3))

def get_hashtags(prompt, platform):
  words= prompt.lower().split()
  tags = ["#"+ word.replace(" ","") for word in words if len(word) > 3]

  platform_tags = {
      "Instagram": ["#instadaily", "#igers", "#picoftheday"],
      "LinkedIn": ["#career", "#leadership", "#networking"],
      "Twitter": ["#tweet","#trending","#news"]
  }
  return " ".join(tags[:5] + random.sample(platform_tags[platform], 2))

def generate_post(prompt, platform):
  #generate caption
  caption = caption_generator(prompt, max_length=50, num_return_sequences=1)[0]['generated_text']

  #Generate Emojis
  emojis = get_emojis(caption)

  #Generate hashtags
  hashtags = get_hashtags(prompt, platform)

  return caption.strip(), emojis, hashtags

interface = gr.Interface(
    fn = generate_post,
    inputs=[
        gr.Textbox(label="Enter keyword or theme"),
        gr.Radio(["Instagram","LinedIn","Twitter"], label="Choose Platform")
    ],
    outputs=[
        gr.Textbox(label="Generated Caption"),
        gr.Textbox(label="Emojis"),
        gr.Textbox(label="Hashtags")
    ],
    title="Social Media Post & Caption Generator",
    description="Generate catchy captions, relevant hashtags, and emojis based on your theme!"
)

interface.launch()

